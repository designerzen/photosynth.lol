import BANJO from "url:/static/wave-tables/general-midi/banjo"
import BARITONE_SAX from "url:/static/wave-tables/general-midi/baritone-sax"
import BASSOON from "url:/static/wave-tables/general-midi/bassoon"
import TROMBONE from "url:/static/wave-tables/general-midi/trombone"
import CHOIR_AAHS from "url:/static/wave-tables/general-midi/choir-aahs"
import DULCIMER from "url:/static/wave-tables/general-midi/dulcimer"
import ENGLISH_HORN from "url:/static/wave-tables/general-midi/english-horn"
import GUITAR from "url:/static/wave-tables/general-midi/guitar"
import HARP from "url:/static/wave-tables/general-midi/harp"
import KOTO from "url:/static/wave-tables/general-midi/koto"
import OCARINA from "url:/static/wave-tables/general-midi/ocarina"
import ORCHESTRAL_HIT from "url:/static/wave-tables/general-midi/orchestral-hit"
import PAN_FLUTE from "url:/static/wave-tables/general-midi/pan-flute"
import PICCOLO from "url:/static/wave-tables/general-midi/piccolo"
import RECORDER from "url:/static/wave-tables/general-midi/recorder"
import SHAKUHACHI from "url:/static/wave-tables/general-midi/shakuhachi"
import SHAMISEN from "url:/static/wave-tables/general-midi/shamisen"
import SOPRANO_SAX from "url:/static/wave-tables/general-midi/soprano-sax"
import STEEL_DRUMS from "url:/static/wave-tables/general-midi/steel-drums"
import SYNTH_CHOIR from "url:/static/wave-tables/general-midi/synth-choir"
import VOICE_OOHS from "url:/static/wave-tables/general-midi/voice-oohs"
import WHISTLE from "url:/static/wave-tables/general-midi/whistle"
import ACCORDION from "url:/static/wave-tables/general-midi/accordion"
import ACOUSTIC_GRAND_PIANO from "url:/static/wave-tables/general-midi/acoustic-grand-piano"
import ACOUSTIC_GUITAR from "url:/static/wave-tables/general-midi/acoustic-guitar"
import BAGPIPES from "url:/static/wave-tables/general-midi/bagpipes"
import BRIGHT_ACOUSTIC_PIANO from "url:/static/wave-tables/general-midi/bright-acoustic-piano"
import CELESTA from "url:/static/wave-tables/general-midi/celesta"
import CHORUSED_ELECTRIC_PIANO from "url:/static/wave-tables/general-midi/chorused-electric-piano"
import CHURCH_ORGAN from "url:/static/wave-tables/general-midi/church-organ"
import CLARINET from "url:/static/wave-tables/general-midi/clarinet"
import CLAVINET from "url:/static/wave-tables/general-midi/clavinet"
import DRAWBAR_ORGAN from "url:/static/wave-tables/general-midi/drawbar-organ"
import ELECTRIC_GRAND_PIANO from "url:/static/wave-tables/general-midi/electric-grand-piano"
import FLUTE from "url:/static/wave-tables/general-midi/flute"
import FRENCH_HORN from "url:/static/wave-tables/general-midi/french-horn"
import GLOCKENSPIEL from "url:/static/wave-tables/general-midi/glockenspiel"
import HARMONICA from "url:/static/wave-tables/general-midi/harmonica"
import HARPSICHORD from "url:/static/wave-tables/general-midi/harpsichord"
import HONKY_TONK_PIANO from "url:/static/wave-tables/general-midi/honky-tonk-piano"
import KALIMBA from "url:/static/wave-tables/general-midi/kalimba"
import MARIMBA from "url:/static/wave-tables/general-midi/marimba"
import MUSIC_BOX from "url:/static/wave-tables/general-midi/music-box"
import OBOE from "url:/static/wave-tables/general-midi/oboe"
import PERCUSSIVE_ORGAN from "url:/static/wave-tables/general-midi/percussive-organ"
import REED_ORGAN from "url:/static/wave-tables/general-midi/reed-organ"
import RHODES_ELECTRIC_PIANO from "url:/static/wave-tables/general-midi/rhodes-electric-piano"
import ROCK_ORGAN from "url:/static/wave-tables/general-midi/rock-organ"
import SITAR from "url:/static/wave-tables/general-midi/sitar"
import TANGO_ACCORDION from "url:/static/wave-tables/general-midi/tango-accordion"
import TRUMPET from "url:/static/wave-tables/general-midi/trumpet"
import TUBULAR_BELLS from "url:/static/wave-tables/general-midi/tubular-bells"
import VIBRAPHONE from "url:/static/wave-tables/general-midi/vibraphone"
import VIOLIN from "url:/static/wave-tables/general-midi/violin"
import XYLOPHONE from "url:/static/wave-tables/general-midi/xylophone"

export const WAVE_TABLE_LOCATIONS = [
    ACCORDION,
    ACOUSTIC_GRAND_PIANO,
    ACOUSTIC_GUITAR,
    BAGPIPES,
    BANJO,
    BARITONE_SAX,
    BASSOON,
    BRIGHT_ACOUSTIC_PIANO,
    CELESTA,
    CHOIR_AAHS,
    CHORUSED_ELECTRIC_PIANO,
    CHURCH_ORGAN,
    CLARINET,
    CLAVINET,
    DRAWBAR_ORGAN,
    DULCIMER,
    ELECTRIC_GRAND_PIANO,
    ENGLISH_HORN,
    FLUTE,
    FRENCH_HORN,
    GLOCKENSPIEL,
    GUITAR,
    HARMONICA,
    HARP,
    HARPSICHORD,
    HONKY_TONK_PIANO,
    KALIMBA,
    KOTO,
    MARIMBA,
    MUSIC_BOX,
    OBOE,
    OCARINA,
    ORCHESTRAL_HIT,
    PAN_FLUTE,
    PERCUSSIVE_ORGAN,
    PICCOLO,
    RECORDER,
    REED_ORGAN,
    RHODES_ELECTRIC_PIANO,
    ROCK_ORGAN,
    SHAKUHACHI,
    SHAMISEN,
    SITAR,
    SOPRANO_SAX,
    STEEL_DRUMS,
    SYNTH_CHOIR,
    TANGO_ACCORDION,
    TROMBONE,
    TRUMPET,
    TUBULAR_BELLS,
    VIBRAPHONE,
    VIOLIN,
    VOICE_OOHS,
    WHISTLE,
    XYLOPHONE
]

export const WAVE_FORM_NAMES = [
    "Accordion",
    "Acoustic Grand Piano",
    "Acoustic Guitar",
    "Bagpipes",
    "Banjo",
    "Baritone Sax",
    "Bassoon",
    "Bright Acoustic Piano",
    "Celesta",
    "Choir Aahs",
    "Chorused Electric Piano",
    "Church Organ",
    "Clarinet",
    "Clavinet",
    "Drawbar Organ",
    "Dulcimer",
    "Electric Grand Piano",
    "English Horn",
    "Flute",
    "French Horn",
    "Glockenspiel",
    "Guitar",
    "Harmonica",
    "Harp",
    "Harpsichord",
    "Honky-tonk Piano",
    "Kalimba",
    "Koto",
    "Marimba",
    "Music Box",
    "Oboe",
    "Ocarina",
    "Orchestral Hit",
    "Pan Flute",
    "Percussive Organ",
    "Piccolo",
    "Recorder",
    "Reed Organ",
    "Rhodes Electric Piano",
    "Rock Organ",
    "Shakuhachi",
    "Shamisen",
    "Sitar",
    "Soprano Sax",
    "Steel Drums",
    "Synth Choir",
    "Tango Accordion",
    "Trombone",
    "Trumpet",
    "Tubular Bells",
    "Vibraphone",
    "Violin",
    "Voice Oohs",
    "Whistle",
    "Xylophone"
]

const waveTables = new Map()

const waveTableNames = new Map()

const assignWaveTables = ( locations, waves, waveMap ) => {
    locations.forEach( (waveTableName, index) => {
        const nameExpanded = waves[index].replaceAll("_"," ")
        waveMap.set(waves[index], waveTableName)
        waveMap.set(waves[index].toLowerCase(), waveTableName)
        waveMap.set(nameExpanded, waveTableName)
        waveMap.set(nameExpanded.toLowerCase(), waveTableName)
    }) 
}

assignWaveTables(WAVE_TABLE_LOCATIONS, WAVE_FORM_NAMES, waveTableNames)

console.info("waveTableNames", waveTableNames)

export const loadWaveTableFromFile = async (waveTableName) => { 
    const url = waveTableNames.get(waveTableName)
    const request = await fetch(url)
    const response = await request.text()
    const data = response.replaceAll( /\n|\r/g, '')
    const delimA = "{'real': ["
    const delimB = ",],'imag': ["
    const delimC = ",]}"

    const parts = data.split(delimB)

    const part1 = parts[0].split(delimA)[1].trim().split(",")
    const part2 = parts[1].replace(delimC, "").trim().split(",")

    const real = part1.map(Number)
    const imag = part2.map(Number)
    const waves = { real, imag }
    
    waveTables.set(waveTableName, waves)
    return waves
}

export const loadWaveTable = async (waveTableName) => { 
    if (waveTables.has(waveTableName) ){
        return waveTables.get(waveTableName)
    }else{
        return loadWaveTableFromFile(waveTableName)
    }
}

export const getRandomWaveTableName = () => { 
    return WAVE_FORM_NAMES[Math.floor(Math.random() * WAVE_FORM_NAMES.length)]
}

export const loadRandomWaveTable = async () => { 
    return loadWaveTable(getRandomWaveTableName())
}
